# TAVI Keypoint Detection

Проект для обнаружения ключевых точек на медицинских изображениях с использованием многовыходной (multi-head) регрессии.

## Описание проекта

Данный проект реализует модель для обнаружения ключевых точек на медицинских изображениях TAVI (Transcatheter Aortic Valve Implantation). Модель использует подход многовыходной регрессии с признаком присутствия, который позволяет одновременно определять:
1. Наличие ключевой точки
2. Координаты (x, y) ключевой точки, если она присутствует

## Структура проекта

```
TAVI_Keypoint_Detection/
├── dataset.py                      # Класс для работы с датасетом
├── model.py                        # Реализация модели с многовыходной архитектурой
├── train.py                        # Скрипт для обучения модели
├── config.yaml                     # Файл с конфигурационными параметрами
├── requirements.txt                # Список зависимостей
└── README.md                       # Описание проекта и инструкции
```

## Особенности реализации

- **Архитектура модели**: Используется предобученная ResNet18 в качестве бэкбона с дополнительными полносвязными слоями для предсказания наличия и координат ключевых точек.
- **Функция потерь**: Комбинация BCE (Binary Cross Entropy) для предсказания наличия точки и L1 Loss для регрессии координат.
- **Аугментации**: Реализованы случайные повороты, масштабирование и отражения для улучшения обобщающей способности модели.

## Классы ключевых точек

Модель работает со следующими группами ключевых точек:
- **group_1**: ["CP"] (1 точка)
- **group_2**: ["FE2_o", "FE1_o", "FE2", "FE1", "EC1", "EC2"] (до 6 точек)
- **group_3**: ["CT1", "CT2", "CD"] (до 3 точек)

## Установка и запуск

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Настройка конфигурации

Перед запуском убедитесь, что в файле `config.yaml` указан правильный путь к датасету и настроены остальные параметры.

### Запуск обучения

```bash
python train.py
```

## Преимущества подхода multi-head регрессии

1. **Простота реализации**: Не требуется генерация и обработка карт тепла (heatmaps).
2. **Эффективность**: Хорошо работает для задач с ограниченным числом ключевых точек.
3. **Гибкость**: Легко обрабатывает случаи, когда некоторые точки отсутствуют на изображении.
4. **Масштабируемость**: Можно легко добавлять новые классы ключевых точек.
